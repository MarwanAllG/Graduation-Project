<!doctype html>
<html lang="en">
{%load static %}
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Car Price Prediction</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" >
      <style>
          @media only screen and (max-width: 720px) {
          .container-fluid {
            width:100% !important
          }
          .btn{
            width:100% !important
          }
        }

      </style>
  </head>
  <body style="background-color:cadetblue">
    <div class="container-fluid ms-auto me-auto w-50  p-3 " style="background-color:cadetblue">
        <img src="{% static 'unij.png' %}" class="img-thumbnail w-25 mx-auto d-block" alt="uni">
        <br>

        <div class="card text-bg-light shadow" >

  <div class="card-body">
   <h4>Kindly, Enter Your Car Information</h4>
        <form>
            <label for="brands" class="form-label fw-bold ">Choose the Brand of Your Car</label>
             <select class="form-select ps form-select-sm border border-dark" aria-label="parent list" name="brand" required id="brands">
            <option selected disabled>Choose a brand</option>
            <option value="chevrolet">Chevrolet</option>
            <option value="ford">Ford</option>
            <option value="gmc">GMC</option>
            <option value="hyundai">Hyundai</option>
            <option value="kia">KIA</option>
            <option value="lexus">Lexus</option>
            <option value="mercedes">Mercedes</option>
            <option value="nissan">Nissan</option>
            <option value="toyota">Toyota</option>
        </select>
        <br>
            <label for="models" class="form-label fw-bold ">Choose the Model From the Brand</label>
         <select class="form-select cs form-select-sm border border-dark" aria-label="child list" name="model" required id="models">
          <option selected>Choose a model of a brand</option>

        </select>
            <br>
         <label for="year" class="form-label fw-bold ">Enter the Year that the Car was Manufactured in</label>
         <input type="text" id="year" class="form-control form-control-sm border border-dark year"  aria-describedby="year" name="year" placeholder="ex. 2002" required>
            <br>
            <label for="colors" class="form-label fw-bold ">Choose the Color of Your Car</label>
            <select id="colors" class="form-select form-select-sm border border-dark color" aria-label="color list" name="color" required>
                <option selected disabled>Choose the model color</option>
                <option value="white">White</option>
                <option value="black">Black</option>
                <option value="brown">Brown</option>
                <option value="gray">Gray</option>
                <option value="blue">Blue</option>
                <option value="yellow">Yellow</option>
                <option value="green">Green</option>
                 <option value="red">Red</option>
            </select>
            <br>
            <label for="fuels" class="form-label fw-bold ">Choose the Type of Fuel the Car Runs on</label>
             <select id="fuels" class="form-select form-select-sm border border-dark fuel" aria-label="fuel list" name="fuel" required>
                <option selected disabled>Choose the Type of Fuel</option>
                <option value="gas">Gas</option>
                 <option value="hybrid">Hybrid</option>
                <option value="diesel">Diesel</option>
            </select>
            <br>
            <label for="gears" class="form-label fw-bold ">Choose the Type of Transmission of the Car</label>
            <select id="gears" class="form-select form-select-sm border border-dark gear" aria-label="gear list" name="gear" required>
                <option selected disabled>Choose the Gear Type</option>
                <option value="automatic">Automatic</option>
                <option value="cvt">CVT</option>
                <option value="manual">Manual</option>
            </select>
             <br>
         <label for="engine" class="form-label fw-bold">Enter the Engine Size</label>
         <input type="number" id="engine" class="form-control form-control-sm border border-dark engine"  aria-describedby="year" name="engine" placeholder="ex. 2.0" required>
            <br>
         <label for="mileage" class="form-label fw-bold">Enter the Mileage in KM</label>
         <input type="number" id="mileage" class="form-control form-control-sm border border-dark mileage"  aria-describedby="year" name="mileage" placeholder="ex. 20000" required>
            <br>
            <label for="regions" class="form-label fw-bold ">Choose the Region in Which the Car is Offered From</label>
         <select id="regions" class="form-select form-select-sm border border-dark region" aria-label="region list" name="region" required>
            <option selected disabled>Choose the region</option>
            <option value="al-baha">Al-Baha</option>
            <option value="makkah">Makkah</option>
             <option value="riyadh">Riyadh</option>
             <option value="najran">Najran</option>
             <option value="al-jouf">Al-Jouf</option>
             <option value="aseer">Aseer</option>
             <option value="hail">Hail</option>
              <option value="eastern">Eastern</option>
              <option value="jizan">Jizan</option>
              <option value="madinah">Madinah</option>
             <option value="northern borders">Northern Borders</option>
             <option value="qassim">Qassim</option>
             <option value="tabouk">Tabouk</option>
        </select>
            <br>


        </form>
       <div class="d-flex justify-content-center">
                 <button class="btn btn-success btsub w-25 me-2 " >Estimate</button>

           <a href="{%url 'home'%}" class="btn btn-danger me-2 w-25 gobackbtn" role="button">Go Back</a>
       </div>

      <div class="modal fade" id="myModal" tabindex="-1" aria-labelledby="ModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">Price Estimation</h1>

      </div>
      <div class="modal-body">
          <p>Your <b class="brandR text-capitalize"></b> <b class="modelR text-capitalize"></b> is estimated to be around <b class="text-danger priceR">20000</b> SAR.</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Done</button>

      </div>
    </div>
  </div>
</div>
  </div>
</div>



    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" ></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
  <script>
      $(document).ready(function(){

            $.ajaxSetup({
              headers: { "X-CSRFToken": '{{csrf_token}}' }
            });



          $(".btsub").on('click',function(){
                   $(".btsub").addClass('disabled');
                   $(".gobackbtn").addClass('disabled');
                  var listdata = {brand:$(".ps").val(),model:$(".cs").val(),year:$(".year").val(),color:$(".color").val(),fuel:$(".fuel").val(),
                  gear:$(".gear").val(),engine:$(".engine").val(),mileage:$(".mileage").val(),region:$(".region").val()}
                    console.log(listdata)
                    $.ajax({
                  type: "POST",
                  url: "{% url 'motor' %}",
                  data: listdata,

                  success: function(response){
                        $(".btsub").removeClass('disabled');
                         $(".gobackbtn").removeClass('disabled');
                        console.log(response)
                        $('.brandR').empty();
                        $('.modelR').empty();
                        $('.priceR').empty();
                        $(".brandR").append($(".ps").val());
                        $(".modelR").append($(".cs").val());
                        $(".priceR").append(response.result);

                         $('#myModal').modal('show');

                    },
                      error: function (xhr, ajaxOptions, thrownError) {
                         $(".btsub").removeClass('disabled');
                         $(".gobackbtn").removeClass('disabled');
                        alert("something went wrong, make sure you fill all the fields");
                      }




                  });



          });



          $(".ps").on('change',function(){
           $('.cs option').remove();
              var data = {psname: this.value,};
              console.log(data)
             $.ajax({
              type: "POST",
              url: "{% url 'index' %}",
              data: data,

              success: function(response){
                    console.log(response.data.data)
                     $('.cs').append($('<option selected disabled>Choose a model of a brand</option>'));
                    $.each(response.data.data, function (i, item) {
                        console.log(item)

                        $('.cs').append($('<option>', {
                            value: item,
                            text : item
                        }));
                    });
                },


              });

              });
});
    </script>
  </body>
</html>